
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Everything you need to know about Fetch.AI." name="description"/>
<link href="https://docs.fetch.ai/integration/" rel="canonical"/>
<meta content="diarmid.campbell@fetch.ai" name="author"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-4.6.3" name="generator"/>
<title>Using public ledgers - AEA Developer Documentation</title>
<link href="../assets/stylesheets/application.adb8469c.css" rel="stylesheet"/>
<script src="../assets/javascripts/modernizr.86422ebf.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
<link href="../assets/fonts/material-icons.css" rel="stylesheet"/>
<link href="../css/my-styles.css" rel="stylesheet"/>
</head>
<body dir="ltr">
<svg class="md-svg">
<defs>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#abstract-class-ledgerapi" tabindex="0">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a aria-label="AEA Developer Documentation" class="md-header-nav__button md-logo" href="https://docs.fetch.ai/" title="AEA Developer Documentation">
<i class="md-icon">code</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
              AEA Developer Documentation
            </span>
<span class="md-header-nav__topic">
              
                Using public ledgers
              
            </span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
</div>
</div>
</nav>
</header>
<div class="md-container">
<nav class="md-tabs md-tabs--active" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="..">
          AEA Framework
        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://docs.fetch.ai/" title="AEA Developer Documentation">
<i class="md-icon">code</i>
</a>
    AEA Developer Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-1" id="nav-1" type="checkbox"/>
<label class="md-nav__link" for="nav-1">
      AEA Framework
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-1">
        AEA Framework
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href=".." title="Welcome">
      Welcome
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-2" id="nav-1-2" type="checkbox"/>
<label class="md-nav__link" for="nav-1-2">
      Concepts
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-2">
        Concepts
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../agent-oriented-development/" title="Agent-oriented development">
      Agent-oriented development
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../vision/" title="Vision">
      Vision
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../app-areas/" title="Application areas">
      Application areas
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../oef-ledger/" title="Relation to OEF and Ledger">
      Relation to OEF and Ledger
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../identity/" title="Identity">
      Identity
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../trust/" title="Trust issues">
      Trust issues
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-3" id="nav-1-3" type="checkbox"/>
<label class="md-nav__link" for="nav-1-3">
      Demos
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-3">
        Demos
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../aries-cloud-agent/" title="Aries Cloud Agent">
      Aries Cloud Agent
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../car-park-skills/" title="Car park skills">
      Car park skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../generic-skills/" title="Generic skills">
      Generic skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gym-example/" title="Gym example">
      Gym example
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gym-skill/" title="Gym skill">
      Gym skill
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ml-skills/" title="ML skills">
      ML skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tac-skills/" title="TAC skills">
      TAC skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tac/" title="TAC external app">
      TAC external app
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../weather-skills/" title="Weather skills">
      Weather skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../thermometer-skills/" title="Thermometer skills">
      Thermometer skills
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4" id="nav-1-4" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4">
      Development
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-4">
        Development
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-1" id="nav-1-4-1" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-1">
      Getting started
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-4-1">
        Getting started
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../steps/" title="Ways to build an AEA">
      Ways to build an AEA
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../quickstart/" title="AEA quick start">
      AEA quick start
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aea-vs-mvc/" title="AEA and web frameworks">
      AEA and web frameworks
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../build-aea-step-by-step/" title="Build an AEA with the CLI">
      Build an AEA with the CLI
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../skill-guide/" title="Build a skill for an AEA">
      Build a skill for an AEA
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../build-aea-programmatically/" title="Build an AEA programmatically">
      Build an AEA programmatically
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../agent-vs-aea/" title="AEAs vs agents">
      AEAs vs agents
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cli-vs-programmatic-aeas/" title="CLI vs programmatic AEAs">
      CLI vs programmatic AEAs
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-2" id="nav-1-4-2" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-2">
      Step by step guides
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-4-2">
        Step by step guides
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../thermometer-skills-step-by-step/" title="Thermometer skills step-by-step">
      Thermometer skills step-by-step
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-3" id="nav-1-4-3" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-3">
      Use case components
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-4-3">
        Use case components
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../generic-skills/" title="Generic skills">
      Generic skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../orm-integration-to-generic/" title="ORM integration">
      ORM integration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../connect-a-frontend/" title="Frontend intergration">
      Frontend intergration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../erc1155-skills/" title="ERC1155 deploy and interact">
      ERC1155 deploy and interact
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../http-connection-and-skill/" title="HTTP Connection">
      HTTP Connection
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-4" id="nav-1-4-4" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-4">
      Architecture
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-4-4">
        Architecture
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../design-principles/" title="Design principles">
      Design principles
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../diagram/" title="Architectural diagram">
      Architectural diagram
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../core-components/" title="Core components">
      Core components
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-5" id="nav-1-4-5" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-5">
      CLI
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-4-5">
        CLI
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../cli-how-to/" title="Installation">
      Installation
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cli-commands/" title="Commands">
      Commands
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../package-imports/" title="File structure">
      File structure
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cli-gui/" title="GUI">
      GUI
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wealth/" title="Generating wealth">
      Generating wealth
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-6" id="nav-1-4-6" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-6">
      Developer guides
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-4-6">
        Developer guides
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../version/" title="Version">
      Version
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../skill/" title="Skill">
      Skill
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../protocol/" title="Protocol">
      Protocol
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../connection/" title="Connection">
      Connection
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../scaffolding/" title="Scaffolding packages">
      Scaffolding packages
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../protocol-generator/" title="Generating protocols">
      Generating protocols
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../logging/" title="Logging">
      Logging
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../raspberry-set-up/" title="Build an AEA on a Raspberry Pi">
      Build an AEA on a Raspberry Pi
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Using public ledgers
      </label>
<a class="md-nav__link md-nav__link--active" href="./" title="Using public ledgers">
      Using public ledgers
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#abstract-class-ledgerapi">
    Abstract class LedgerApi
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fetchai-ledger">
    Fetch.ai Ledger
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ethereum-ledger">
    Ethereum Ledger
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fetchai-implementation">
    Fetch.ai implementation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ethereum-implementation">
    Ethereum implementation
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../multiplexer-standalone/" title="Use multiplexer stand-alone">
      Use multiplexer stand-alone
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../standalone-transaction/" title="Create stand-alone transaction">
      Create stand-alone transaction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../decision-maker-transaction/" title="Create decision-maker transaction">
      Create decision-maker transaction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deployment/" title="Deployment">
      Deployment
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../known-limits/" title="Known limitations">
      Known limitations
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7" id="nav-1-4-7" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7">
      API
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-4-7">
        API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/aea/" title="AEA">
      AEA
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/aea_builder/" title="AEA Builder">
      AEA Builder
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/agent/" title="Agent">
      Agent
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-4" id="nav-1-4-7-4" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-4">
      Configurations
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-4">
        Configurations
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/configurations/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/configurations/components/" title="Components">
      Components
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/configurations/loader/" title="Loader">
      Loader
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-5" id="nav-1-4-7-5" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-5">
      Connections
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-5">
        Connections
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/connections/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/connections/stub/connection/" title="Stub Connection">
      Stub Connection
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/context/base/" title="Context">
      Context
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-7" id="nav-1-4-7-7" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-7">
      Contracts
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-7">
        Contracts
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/contracts/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/contracts/ethereum/" title="Ethereum">
      Ethereum
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-8" id="nav-1-4-7-8" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-8">
      Crypto
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-8">
        Crypto
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/crypto/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/crypto/ethereum/" title="Ethereum">
      Ethereum
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/crypto/fetchai/" title="Fetchai">
      Fetchai
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/crypto/ledger_apis/" title="LedgerApis">
      LedgerApis
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/crypto/wallet/" title="Wallet">
      Wallet
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-9" id="nav-1-4-7-9" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-9">
      Decision Maker
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-9">
        Decision Maker
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/decision_maker/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-9-2" id="nav-1-4-7-9-2" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-9-2">
      Messages
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="5">
<label class="md-nav__title" for="nav-1-4-7-9-2">
        Messages
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/decision_maker/messages/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/decision_maker/messages/state_update/" title="State Update">
      State Update
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/decision_maker/messages/transaction/" title="Transaction">
      Transaction
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-10" id="nav-1-4-7-10" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-10">
      Helpers
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-10">
        Helpers
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-10-1" id="nav-1-4-7-10-1" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-10-1">
      Dialogue
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="5">
<label class="md-nav__title" for="nav-1-4-7-10-1">
        Dialogue
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/helpers/dialogue/base/" title="Base">
      Base
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-10-2" id="nav-1-4-7-10-2" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-10-2">
      IPFS
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="5">
<label class="md-nav__title" for="nav-1-4-7-10-2">
        IPFS
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/helpers/ipfs/base/" title="Base">
      Base
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-10-3" id="nav-1-4-7-10-3" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-10-3">
      Preferences
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="5">
<label class="md-nav__title" for="nav-1-4-7-10-3">
        Preferences
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/helpers/preference_representations/base/" title="Base">
      Base
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-10-4" id="nav-1-4-7-10-4" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-10-4">
      Search
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="5">
<label class="md-nav__title" for="nav-1-4-7-10-4">
        Search
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/helpers/search/generic/" title="Generic">
      Generic
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/helpers/search/models/" title="Models">
      Models
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/identity/base/" title="Identity">
      Identity
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/mail/base/" title="Mail">
      Mail
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-13" id="nav-1-4-7-13" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-13">
      Protocols
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-13">
        Protocols
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/protocols/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/protocols/generator/" title="Generator">
      Generator
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-13-3" id="nav-1-4-7-13-3" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-13-3">
      Default Protocol
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="5">
<label class="md-nav__title" for="nav-1-4-7-13-3">
        Default Protocol
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/protocols/default/custom_types/" title="Custom Types">
      Custom Types
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/protocols/default/message/" title="Message">
      Message
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/protocols/default/serialization/" title="Serialization">
      Serialization
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/registries/resources/" title="Resources">
      Resources
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4-7-15" id="nav-1-4-7-15" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4-7-15">
      Skills
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="4">
<label class="md-nav__title" for="nav-1-4-7-15">
        Skills
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/skills/base/" title="Base">
      Base
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/skills/error/handlers/" title="Error Skill">
      Error Skill
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/skills/behaviours/" title="Behaviors">
      Behaviors
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/skills/tasks/" title="Task">
      Task
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../questions-and-answers/" title="Q&amp;A">
      Q&amp;A
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#abstract-class-ledgerapi">
    Abstract class LedgerApi
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fetchai-ledger">
    Fetch.ai Ledger
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ethereum-ledger">
    Ethereum Ledger
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fetchai-implementation">
    Fetch.ai implementation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ethereum-implementation">
    Ethereum implementation
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1>Using public ledgers</h1>
<p>In this section, we show you how to integrate the AEA with the Fetch.ai and third-party ledgers.</p>
<p>The framework currently natively supports two ledgers:</p>
<ul>
<li>Fetch.ai</li>
<li>Ethereum</li>
</ul>
<p>To this end, the framework wraps APIs to interact with the two ledgers and exposes them in the <code>LedgerApis</code> class. The framework also wraps the account APIs to create identities on both ledgers and exposes them in the <code>Wallet</code>.</p>
<p>The <code>Wallet</code> holds instantiation of the abstract <code>Crypto</code> base class, in particular <code>FetchaiCrypto</code> and <code>EthereumCrypto</code>.</p>
<p>The <code>LedgerApis</code> holds instantiation of the abstract <code>LedgerApi</code> base class, in particular <code>FetchaiLedgerApi</code> and <code>EthereumLedgerApi</code>.
You can think the concrete implementations of the base class <code>LedgerApi</code> as wrappers of the blockchain specific python SDK. </p>
<h2 id="abstract-class-ledgerapi">Abstract class LedgerApi</h2>
<p>Each <code>LedgerApi</code> must implement all the methods based on the abstract class.
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">LedgerApi</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">"""Interface for ledger APIs."""</span>

    <span class="n">identifier</span> <span class="o">=</span> <span class="s2">"base"</span>  <span class="c1"># type: str</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">api</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Get the underlying API object.</span>
<span class="sd">        If there is no such object, return None.</span>
<span class="sd">        """</span>
</code></pre></div>
The api property can be used for low-level operation with the concrete ledger APIs.</p>
<p><div class="highlight"><pre><span></span><code>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Get the balance of a given account.</span>

<span class="sd">        This usually takes the form of a web request to be waited synchronously.</span>

<span class="sd">        :param address: the address.</span>
<span class="sd">        :return: the balance.</span>
<span class="sd">        """</span>
</code></pre></div>
The <code>get_balance</code> method returns the amount of tokens we hold for a specific address.
<div class="highlight"><pre><span></span><code>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">send_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">crypto</span><span class="p">:</span> <span class="n">Crypto</span><span class="p">,</span>
        <span class="n">destination_address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">,</span>
        <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">tx_fee</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">"""</span>
<span class="sd">        Submit a transaction to the ledger.</span>

<span class="sd">        If the mandatory arguments are not enough for specifying a transaction</span>
<span class="sd">        in the concrete ledger API, use keyword arguments for the additional parameters.</span>

<span class="sd">        :param tx_nonce: verifies the authenticity of the tx</span>
<span class="sd">        :param crypto: the crypto object associated to the payer.</span>
<span class="sd">        :param destination_address: the destination address of the payee.</span>
<span class="sd">        :param amount: the amount of wealth to be transferred.</span>
<span class="sd">        :param tx_fee: the transaction fee.</span>
<span class="sd">        :return: tx digest if successful, otherwise None</span>
<span class="sd">        """</span>
</code></pre></div>
The <code>send_transaction</code> is where we must implement the logic for sending a transaction to the ledger. </p>
<p><div class="highlight"><pre><span></span><code>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_transaction_settled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Check whether a transaction is settled or not.</span>

<span class="sd">        :param tx_digest: the digest associated to the transaction.</span>
<span class="sd">        :return: True if the transaction has been settled, False o/w.</span>
<span class="sd">        """</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">validate_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Check whether a transaction is valid or not.</span>

<span class="sd">        :param seller: the address of the seller.</span>
<span class="sd">        :param client: the address of the client.</span>
<span class="sd">        :param tx_nonce: the transaction nonce.</span>
<span class="sd">        :param amount: the amount we expect to get from the transaction.</span>
<span class="sd">        :param tx_digest: the transaction digest.</span>

<span class="sd">        :return: True if the transaction referenced by the tx_digest matches the terms.</span>
<span class="sd">        """</span>
</code></pre></div>
The <code>is_transaction_settled</code> and <code>validate_transaction</code> are two functions that helps us to verify a transaction digest.
<div class="highlight"><pre><span></span><code>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">generate_tx_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Generate a random str message.</span>

<span class="sd">        :param seller: the address of the seller.</span>
<span class="sd">        :param client: the address of the client.</span>
<span class="sd">        :return: return the hash in hex.</span>
<span class="sd">        """</span>
</code></pre></div>
Lastly, we implemented a support function that generates a random hash to help us with verifying the uniqueness of transactions. The sender of the funds must include this hash in the transaction
as extra data for the transaction to be considered valid.</p>
<p>Next, we are going to discuss the different implementation of <code>send_transaction</code> and <code>validate_transacaction</code> for the two natively supported ledgers of the framework.</p>
<h2 id="fetchai-ledger">Fetch.ai Ledger</h2>
<p><div class="highlight"><pre><span></span><code> <span class="k">def</span> <span class="nf">send_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">crypto</span><span class="p">:</span> <span class="n">Crypto</span><span class="p">,</span>
         <span class="n">destination_address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_fee</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span>
     <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
         <span class="sd">"""Submit a transaction to the ledger."""</span>
         <span class="n">tx_digest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span>
             <span class="n">crypto</span><span class="o">.</span><span class="n">entity</span><span class="p">,</span> <span class="n">destination_address</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">tx_fee</span>
         <span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="k">return</span> <span class="n">tx_digest</span>
</code></pre></div>
As you can see, the implementation for sending a transcation to the Fetch.ai ledger is relatively trivial.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We cannot use the tx_nonce yet in the Fetch.ai ledger.</p>
</div>
<p><div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">is_transaction_settled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">"""Check whether a transaction is settled or not."""</span>
         <span class="n">tx_status</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TxStatus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">))</span>
         <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">False</span>
         <span class="k">if</span> <span class="n">tx_status</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="n">SUCCESSFUL_TERMINAL_STATES</span><span class="p">:</span>
             <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">True</span>
         <span class="k">return</span> <span class="n">is_successful</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>    <span class="k">def</span> <span class="nf">validate_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">"""</span>
<span class="sd">         Check whether a transaction is valid or not.</span>

<span class="sd">         :param seller: the address of the seller.</span>
<span class="sd">         :param client: the address of the client.</span>
<span class="sd">         :param tx_nonce: the transaction nonce.</span>
<span class="sd">         :param amount: the amount we expect to get from the transaction.</span>
<span class="sd">         :param tx_digest: the transaction digest.</span>

<span class="sd">         :return: True if the random_message is equals to tx['input']</span>
<span class="sd">         """</span>
         <span class="n">tx_contents</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TxContents</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">contents</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">))</span>
         <span class="n">transfers</span> <span class="o">=</span> <span class="n">tx_contents</span><span class="o">.</span><span class="n">transfers</span>
         <span class="n">seller_address</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="n">seller</span><span class="p">)</span>
         <span class="n">is_valid</span> <span class="o">=</span> <span class="p">(</span>
             <span class="nb">str</span><span class="p">(</span><span class="n">tx_contents</span><span class="o">.</span><span class="n">from_address</span><span class="p">)</span> <span class="o">==</span> <span class="n">client</span>
             <span class="ow">and</span> <span class="n">amount</span> <span class="o">==</span> <span class="n">transfers</span><span class="p">[</span><span class="n">seller_address</span><span class="p">]</span>
         <span class="p">)</span>
         <span class="n">is_settled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_transaction_settled</span><span class="p">(</span><span class="n">tx_digest</span><span class="o">=</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="n">result</span> <span class="o">=</span> <span class="n">is_valid</span> <span class="ow">and</span> <span class="n">is_settled</span>
         <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
Inside the <code>validate_transcation</code> we request the contents of the transaction based on the tx_digest we received. We are checking that the address
of the client is the same as the one that is inside the <code>from</code> field of the transaction. Lastly, we are checking that the transaction is settled.
If both of these checks return True we consider the transaction as valid.</p>
<h2 id="ethereum-ledger">Ethereum Ledger</h2>
<p><div class="highlight"><pre><span></span><code>     <span class="k">def</span> <span class="nf">send_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">crypto</span><span class="p">:</span> <span class="n">Crypto</span><span class="p">,</span>
         <span class="n">destination_address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_fee</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">chain_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span>
     <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
         <span class="sd">"""</span>
<span class="sd">         Submit a transaction to the ledger.</span>

<span class="sd">         :param tx_nonce: verifies the authenticity of the tx</span>
<span class="sd">         :param crypto: the crypto object associated to the payer.</span>
<span class="sd">         :param destination_address: the destination address of the payee.</span>
<span class="sd">         :param amount: the amount of wealth to be transferred.</span>
<span class="sd">         :param tx_fee: the transaction fee.</span>
<span class="sd">         :param chain_id: the Chain ID of the Ethereum transaction. Default is 1 (i.e. mainnet).</span>
<span class="sd">         :return: the transaction digest, or None if not available.</span>
<span class="sd">         """</span>
         <span class="n">nonce</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransactionCount</span><span class="p">(</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">toChecksumAddress</span><span class="p">(</span><span class="n">crypto</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
         <span class="p">)</span>
         <span class="n">transaction</span> <span class="o">=</span> <span class="p">{</span>
             <span class="s2">"nonce"</span><span class="p">:</span> <span class="n">nonce</span><span class="p">,</span>
             <span class="s2">"chainId"</span><span class="p">:</span> <span class="n">chain_id</span><span class="p">,</span>
             <span class="s2">"to"</span><span class="p">:</span> <span class="n">destination_address</span><span class="p">,</span>
             <span class="s2">"value"</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
             <span class="s2">"gas"</span><span class="p">:</span> <span class="n">tx_fee</span><span class="p">,</span>
             <span class="s2">"gasPrice"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">toWei</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gas_price</span><span class="p">,</span> <span class="n">GAS_ID</span><span class="p">),</span>
             <span class="s2">"data"</span><span class="p">:</span> <span class="n">tx_nonce</span><span class="p">,</span>
         <span class="p">}</span>
         <span class="n">gas_estimation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">estimateGas</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="n">transaction</span><span class="p">)</span>
         <span class="k">assert</span> <span class="p">(</span>
             <span class="n">tx_fee</span> <span class="o">&gt;=</span> <span class="n">gas_estimation</span>
         <span class="p">),</span> <span class="s2">"Need to increase tx_fee in the configs to cover the gas consumption of the transaction. Estimated gas consumption is: </span><span class="si">{}</span><span class="s2">."</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
             <span class="n">gas_estimation</span>
         <span class="p">)</span>
         <span class="n">signed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">signTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

         <span class="n">hex_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">sendRawTransaction</span><span class="p">(</span><span class="n">signed</span><span class="o">.</span><span class="n">rawTransaction</span><span class="p">)</span>

         <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"TX Hash: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">hex_value</span><span class="o">.</span><span class="n">hex</span><span class="p">())))</span>
         <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
             <span class="k">try</span><span class="p">:</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransactionReceipt</span><span class="p">(</span><span class="n">hex_value</span><span class="p">)</span>
                 <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"transaction validated - exiting"</span><span class="p">)</span>
                 <span class="n">tx_digest</span> <span class="o">=</span> <span class="n">hex_value</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
                 <span class="k">break</span>
             <span class="k">except</span> <span class="n">web3</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">TransactionNotFound</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                 <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"transaction not found - sleeping for 3.0 seconds"</span><span class="p">)</span>
                 <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
         <span class="k">return</span> <span class="n">tx_digest</span>
</code></pre></div>
On contrary to the Fetch.ai implementation of the <code>send_transaction</code> function, the Ethereum implementation is more complicated. This happens because we must create 
the transaction dictionary and send a raw transaction.</p>
<ul>
<li>The <code>nonce</code> is a counter for the transaction we are sending. This is an auto-increment int based on how many transactions we are sending from the specific account.</li>
<li>The <code>chain_id</code> specifies if we are trying to reach the <code>mainnet</code> or another <code>testnet</code>.</li>
<li>The <code>to</code> field is the address we want to send the funds.</li>
<li>The <code>value</code> is the number of tokens we want to transfer.</li>
<li>The <code>gas</code> is the price we are paying to be able to send the transaction.</li>
<li>The <code>gasPrice</code> is the price of the gas we want to pay.</li>
<li>The <code>data</code> in the field that enables to send custom data (originally is used to send data to a smart contract).</li>
</ul>
<p>Once we filled the transaction dictionary. We are checking that the transaction fee is more than the estimated gas for the transaction otherwise we will not be able to complete the transfer. Then we are signing and we are sending the transaction. Once we get the transaction receipt we consider the transaction completed and
we return the transaction digest. </p>
<p><div class="highlight"><pre><span></span><code> <span class="k">def</span> <span class="nf">is_transaction_settled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">"""Check whether a transaction is settled or not."""</span>
         <span class="n">tx_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransactionReceipt</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">False</span>
         <span class="k">if</span> <span class="n">tx_status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
             <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">True</span>
         <span class="k">return</span> <span class="n">is_successful</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">validate_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
     <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">"""</span>
<span class="sd">         Check whether a transaction is valid or not.</span>

<span class="sd">         :param seller: the address of the seller.</span>
<span class="sd">         :param client: the address of the client.</span>
<span class="sd">         :param tx_nonce: the transaction nonce.</span>
<span class="sd">         :param amount: the amount we expect to get from the transaction.</span>
<span class="sd">         :param tx_digest: the transaction digest.</span>

<span class="sd">         :return: True if the random_message is equals to tx['input']</span>
<span class="sd">         """</span>

         <span class="n">tx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransaction</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="n">is_valid</span> <span class="o">=</span> <span class="p">(</span>
             <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"input"</span><span class="p">)</span> <span class="o">==</span> <span class="n">tx_nonce</span>
             <span class="ow">and</span> <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"value"</span><span class="p">)</span> <span class="o">==</span> <span class="n">amount</span>
             <span class="ow">and</span> <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"from"</span><span class="p">)</span> <span class="o">==</span> <span class="n">client</span>
             <span class="ow">and</span> <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"to"</span><span class="p">)</span> <span class="o">==</span> <span class="n">seller</span>
         <span class="p">)</span>
         <span class="k">return</span> <span class="n">is_valid</span>
</code></pre></div>
The <code>validate_transaction</code> and <code>is_transaction_settled</code> functions help us to check if a transaction digest is valid and is settled. 
In the Ethereum API, we can pass the <code>tx_nonce</code>, so we can check that it's the same. If it is different, we consider that transaction as no valid. The same happens if any of <code>amount</code>, <code>client</code> address
or the <code>seller</code> address is different.</p>
<p>Lastly, the <code>generate_tx_nonce</code> function is the same for both <code>LedgerApi</code> implementations but we use different hashing functions. 
Both use the timestamp as a random factor alongside the seller and client addresses.</p>
<h4 id="fetchai-implementation">Fetch.ai implementation</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_tx_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Generate a random str message.</span>

<span class="sd">    :param seller: the address of the seller.</span>
<span class="sd">    :param client: the address of the client.</span>
<span class="sd">    :return: return the hash in hex.</span>
<span class="sd">    """</span>

    <span class="n">time_stamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="n">seller</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">seller</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">client</span><span class="p">)</span>
    <span class="n">aggregate_hash</span> <span class="o">=</span> <span class="n">sha256_hash</span><span class="p">(</span>
        <span class="sa">b</span><span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">seller</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">client</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">time_stamp</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">"big"</span><span class="p">)])</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">aggregate_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</code></pre></div>
<h4 id="ethereum-implementation">Ethereum implementation</h4>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_tx_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
         <span class="sd">"""</span>
<span class="sd">         Generate a unique hash to distinguish txs with the same terms.</span>

<span class="sd">         :param seller: the address of the seller.</span>
<span class="sd">         :param client: the address of the client.</span>
<span class="sd">         :return: return the hash in hex.</span>
<span class="sd">         """</span>
         <span class="n">time_stamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
         <span class="n">aggregate_hash</span> <span class="o">=</span> <span class="n">Web3</span><span class="o">.</span><span class="n">keccak</span><span class="p">(</span>
             <span class="sa">b</span><span class="s2">""</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">seller</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">client</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">time_stamp</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">"big"</span><span class="p">)])</span>
         <span class="p">)</span>
         <span class="k">return</span> <span class="n">aggregate_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</code></pre></div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../raspberry-set-up/" rel="prev" title="Build an AEA on a Raspberry Pi">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Build an AEA on a Raspberry Pi
              </span>
</div>
</a>
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../multiplexer-standalone/" rel="next" title="Use multiplexer stand-alone">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Use multiplexer stand-alone
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" rel="noopener" target="_blank">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs</a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/application.c33a9706.js"></script>
<script>app.initialize({version:"1.1",url:{base:".."}})</script>
<script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
</body>
</html>