
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Everything you need to know about Fetch.AI." name="description"/>
<link href="https://docs.fetch.ai/skill-guide/" rel="canonical"/>
<meta content="diarmid.campbell@fetch.ai" name="author"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.0.4, mkdocs-material-4.6.0" name="generator"/>
<title>Build a skill for an AEA - Fetch.AI Developer Documentation</title>
<link href="../assets/stylesheets/application.1b62728e.css" rel="stylesheet"/>
<script src="../assets/javascripts/modernizr.268332fc.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
<link href="../assets/fonts/material-icons.css" rel="stylesheet"/>
<link href="../css/my-styles.css" rel="stylesheet"/>
</head>
<body dir="ltr">
<svg class="md-svg">
<defs>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#dependencies" tabindex="1">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a class="md-header-nav__button md-logo" href="https://docs.fetch.ai/" title="Fetch.AI Developer Documentation">
<i class="md-icon">code</i>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
              Fetch.AI Developer Documentation
            </span>
<span class="md-header-nav__topic">
              
                Build a skill for an AEA
              
            </span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
</div>
</div>
</nav>
</header>
<div class="md-container">
<nav class="md-tabs md-tabs--active" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="..">
          Autonomous Economic Agent Framework
        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://docs.fetch.ai/" title="Fetch.AI Developer Documentation">
<i class="md-icon">code</i>
</a>
    Fetch.AI Developer Documentation
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-1" id="nav-1" type="checkbox"/>
<label class="md-nav__link" for="nav-1">
      Autonomous Economic Agent Framework
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-1">
        Autonomous Economic Agent Framework
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href=".." title="Welcome">
      Welcome
    </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-1-2" id="nav-1-2" type="checkbox"/>
<label class="md-nav__link" for="nav-1-2">
      Getting started
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-2">
        Getting started
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../steps/" title="Ways to build an AEA">
      Ways to build an AEA
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../quickstart/" title="AEA quick start">
      AEA quick start
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aea-vs-mvc/" title="AEA and Web Frameworks">
      AEA and Web Frameworks
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Build a skill for an AEA
      </label>
<a class="md-nav__link md-nav__link--active" href="./" title="Build a skill for an AEA">
      Build a skill for an AEA
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#dependencies">
    Dependencies
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-setup">
    Step 1: Setup
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-develop-a-behaviour">
    Step 2: Develop a Behaviour
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-develop-a-handler">
    Step 3: Develop a Handler
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-develop-a-task">
    Step 4: Develop a Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-5-create-the-config-file">
    Step 5: Create the config file
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-6-add-the-oef-protocol-and-connection">
    Step 6: Add the oef protocol and connection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-7-run-the-aea">
    Step 7: Run the AEA
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#now-its-your-turn">
    Now it's your turn
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../build-aea-programmatically/" title="Build an AEA programmatically">
      Build an AEA programmatically
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../agent-vs-aea/" title="AEAs vs Agents">
      AEAs vs Agents
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-3" id="nav-1-3" type="checkbox"/>
<label class="md-nav__link" for="nav-1-3">
      The AEA universe
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-3">
        The AEA universe
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../agent-oriented-development/" title="Agent-oriented development">
      Agent-oriented development
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../vision/" title="Vision">
      Vision
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../app-areas/" title="Application areas">
      Application areas
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../oef-ledger/" title="Relation to OEF and Ledger">
      Relation to OEF and Ledger
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../trust/" title="Trust issues">
      Trust issues
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-4" id="nav-1-4" type="checkbox"/>
<label class="md-nav__link" for="nav-1-4">
      Demo guides
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-4">
        Demo guides
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../car-park-skills/" title="Car park skills">
      Car park skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gym-example/" title="Gym example">
      Gym example
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../gym-skill/" title="Gym skill">
      Gym skill
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ml-skills/" title="ML skills">
      ML skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tac-skills/" title="TAC skills">
      TAC skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tac/" title="TAC external app">
      TAC external app
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../weather-skills/" title="Weather skills">
      Weather skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../thermometer-skills/" title="Thermometer skills">
      Thermometer skills
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-5" id="nav-1-5" type="checkbox"/>
<label class="md-nav__link" for="nav-1-5">
      Use cases
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-5">
        Use cases
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../generic-skills/" title="Generic skills">
      Generic skills
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../orm-integration-to-generic/" title="ORM integration">
      ORM integration
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-6" id="nav-1-6" type="checkbox"/>
<label class="md-nav__link" for="nav-1-6">
      Step by step guides
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-6">
        Step by step guides
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../thermometer-skills-step-by-step/" title="Thermometer skills step by step">
      Thermometer skills step by step
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-7" id="nav-1-7" type="checkbox"/>
<label class="md-nav__link" for="nav-1-7">
      Architecture
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-7">
        Architecture
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../design-principles/" title="Design principles">
      Design principles
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../diagram/" title="Architectural diagram">
      Architectural diagram
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../core-components/" title="Core components">
      Core components
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../file-structure/" title="File structure">
      File structure
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-8" id="nav-1-8" type="checkbox"/>
<label class="md-nav__link" for="nav-1-8">
      Developer guides
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-1-8">
        Developer guides
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../version/" title="Version">
      Version
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../skill/" title="Skill">
      Skill
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../protocol/" title="Protocol">
      Protocol
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../connection/" title="Connection">
      Connection
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../scaffolding/" title="Scaffolding packages">
      Scaffolding packages
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../generator/" title="Generating protocols">
      Generating protocols
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../logging/" title="Logging">
      Logging
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-8-8" id="nav-1-8-8" type="checkbox"/>
<label class="md-nav__link" for="nav-1-8-8">
      CLI
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="3">
<label class="md-nav__title" for="nav-1-8-8">
        CLI
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../cli-how-to/" title="CLI tool">
      CLI tool
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cli-commands/" title="Commands">
      Commands
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../cli-gui/" title="GUI">
      GUI
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../wealth/" title="Generating wealth">
      Generating wealth
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../raspberry-set-up/" title="Build an AEA on a Raspberry Pi">
      Build an AEA on a Raspberry Pi
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../integration/" title="Integrate with third parties">
      Integrate with third parties
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../multiplexer-standalone/" title="Use multiplexer stand-alone">
      Use multiplexer stand-alone
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#dependencies">
    Dependencies
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-1-setup">
    Step 1: Setup
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-2-develop-a-behaviour">
    Step 2: Develop a Behaviour
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-3-develop-a-handler">
    Step 3: Develop a Handler
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-4-develop-a-task">
    Step 4: Develop a Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-5-create-the-config-file">
    Step 5: Create the config file
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-6-add-the-oef-protocol-and-connection">
    Step 6: Add the oef protocol and connection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#step-7-run-the-aea">
    Step 7: Run the AEA
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#now-its-your-turn">
    Now it's your turn
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1>Build a skill for an AEA</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before developing your first skill, please read the <a href="../skill/">skill guide</a>.</p>
</div>
<h3 id="dependencies">Dependencies</h3>
<p>Follow the <a href="../quickstart/#preliminaries">Preliminaries</a> and <a href="../quickstart/#installation">Installation</a> sections from the AEA quick start.</p>
<h2 id="step-1-setup">Step 1: Setup</h2>
<p>We will first create an AEA and add a scaffold skill, which we call <code>my_search</code>.</p>
<div class="highlight"><pre><span></span>aea create my_aea <span class="o">&amp;&amp;</span> <span class="nb">cd</span> my_aea
aea scaffold skill my_search
</pre></div>
<p>In the following steps, we replace each one of the scaffolded <code>Behaviour</code>, <code>Handler</code> and <code>Task</code> in <code>my_aea/skills/my_search</code> with our implementation. We will build a simple skill which lets the AEA send a search query to the <a href="https://docs.fetch.ai/oef/">OEF</a> and process the resulting response.</p>
<h2 id="step-2-develop-a-behaviour">Step 2: Develop a Behaviour</h2>
<p>A <code>Behaviour</code> class contains the business logic specific to initial actions initiated by the AEA rather than reactions to other events.</p>
<p>In this example, we implement a simple search behaviour. Each time, <code>act()</code> gets called by the main agent loop, we will send a search request to the OEF.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">aea.helpers.search.models</span> <span class="kn">import</span> <span class="n">Constraint</span><span class="p">,</span> <span class="n">ConstraintType</span><span class="p">,</span> <span class="n">Query</span>
<span class="kn">from</span> <span class="nn">aea.skills.behaviours</span> <span class="kn">import</span> <span class="n">TickerBehaviour</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef.message</span> <span class="kn">import</span> <span class="n">OEFMessage</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef.serialization</span> <span class="kn">import</span> <span class="n">DEFAULT_OEF</span><span class="p">,</span> <span class="n">OEFSerializer</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">"aea.my_search_skill"</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MySearchBehaviour</span><span class="p">(</span><span class="n">TickerBehaviour</span><span class="p">):</span>
    <span class="sd">"""This class provides a simple search behaviour."""</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""Initialize the search behaviour."""</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sent_search_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Implement the setup.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">"[</span><span class="si">{}</span><span class="s2">]: setting up MySearchBehaviour"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Implement the act.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sent_search_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">search_constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">Constraint</span><span class="p">(</span><span class="s2">"country"</span><span class="p">,</span> <span class="n">ConstraintType</span><span class="p">(</span><span class="s2">"=="</span><span class="p">,</span> <span class="s2">"UK"</span><span class="p">))]</span>
        <span class="n">search_query_w_empty_model</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span><span class="n">search_constraints</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">search_request</span> <span class="o">=</span> <span class="n">OEFMessage</span><span class="p">(</span>
            <span class="nb">type</span><span class="o">=</span><span class="n">OEFMessage</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">SEARCH_SERVICES</span><span class="p">,</span>
            <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sent_search_count</span><span class="p">,</span>
            <span class="n">query</span><span class="o">=</span><span class="n">search_query_w_empty_model</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">"[</span><span class="si">{}</span><span class="s2">]: sending search request to OEF, search_count=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sent_search_count</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">outbox</span><span class="o">.</span><span class="n">put_message</span><span class="p">(</span>
            <span class="n">to</span><span class="o">=</span><span class="n">DEFAULT_OEF</span><span class="p">,</span>
            <span class="n">sender</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_address</span><span class="p">,</span>
            <span class="n">protocol_id</span><span class="o">=</span><span class="n">OEFMessage</span><span class="o">.</span><span class="n">protocol_id</span><span class="p">,</span>
            <span class="n">message</span><span class="o">=</span><span class="n">OEFSerializer</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">search_request</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Implement the task teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">"[</span><span class="si">{}</span><span class="s2">]: tearing down MySearchBehaviour"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
<p>Searches are proactive and, as such, well placed in a <code>Behaviour</code>. Specifically, we subclass the <code>TickerBehaviour</code> as it allows us to repeatedly search at a defined tick interval.</p>
<p>We place this code in <code>my_aea/skills/my_search/behaviours.py</code>.</p>
<h2 id="step-3-develop-a-handler">Step 3: Develop a Handler</h2>
<p>So far, we have tasked the AEA with sending search requests to the OEF. However, we have no way of handling the responses sent to the AEA by the OEF at the moment. The AEA would simply respond to the OEF via the default <code>error</code> skill which sends all unrecognised envelopes back to the sender.</p>
<p>Let us now implement a handler to deal with the incoming search responses.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">aea.skills.base</span> <span class="kn">import</span> <span class="n">Handler</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.oef.message</span> <span class="kn">import</span> <span class="n">OEFMessage</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">"aea.my_search_skill"</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MySearchHandler</span><span class="p">(</span><span class="n">Handler</span><span class="p">):</span>
    <span class="sd">"""This class provides a simple search handler."""</span>

    <span class="n">SUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="n">OEFMessage</span><span class="o">.</span><span class="n">protocol_id</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">"""Initialize the handler."""</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">received_search_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""Set up the handler."""</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"[</span><span class="si">{}</span><span class="s2">]: setting up MySearchHandler"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">OEFMessage</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Handle the message.</span>

<span class="sd">        :param message: the message.</span>
<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="n">msg_type</span> <span class="o">=</span> <span class="n">OEFMessage</span><span class="o">.</span><span class="n">Type</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"type"</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">msg_type</span> <span class="ow">is</span> <span class="n">OEFMessage</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">SEARCH_RESULT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">received_search_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">nb_agents_found</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"agents"</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">"[</span><span class="si">{}</span><span class="s2">]: found number of agents=</span><span class="si">{}</span><span class="s2">, received search count=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">,</span> <span class="n">nb_agents_found</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">received_search_count</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Teardown the handler.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">"[</span><span class="si">{}</span><span class="s2">]: tearing down MySearchHandler"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">)</span>
        <span class="p">)</span>
</pre></div>
<p>We create a handler which is registered for the <code>oef</code> protocol. Whenever it receives a search result, we log the number of agents returned in the search - the agents matching the search query - and update the counter of received searches.</p>
<p>Note, how the handler simply reacts to incoming events (i.e. messages). It could initiate further actions, however, they are still reactions to the upstream search event.</p>
<p>We place this code in <code>my_aea/skills/my_search/handlers.py</code>.</p>
<h2 id="step-4-develop-a-task">Step 4: Develop a Task</h2>
<p>We have implemented a behaviour and a handler. We conclude by implementing a task. Here we can implement background logic. We will implement a trivial check on the difference between the amount of search requests sent and responses received.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">from</span> <span class="nn">aea.skills.tasks</span> <span class="kn">import</span> <span class="n">Task</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">"aea.my_search_skill"</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MySearchTask</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
    <span class="sd">"""This class scaffolds a task."""</span>

    <span class="k">def</span> <span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Implement the setup.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"[</span><span class="si">{}</span><span class="s2">]: setting up MySearchTask"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Implement the task execution.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># to slow down the AEA</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">"[</span><span class="si">{}</span><span class="s2">]: number of search requests sent=</span><span class="si">{}</span><span class="s2"> vs. number of search responses received=</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">behaviours</span><span class="o">.</span><span class="n">my_search_behaviour</span><span class="o">.</span><span class="n">sent_search_count</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">my_search_handler</span><span class="o">.</span><span class="n">received_search_count</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Implement the task teardown.</span>

<span class="sd">        :return: None</span>
<span class="sd">        """</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"[</span><span class="si">{}</span><span class="s2">]: tearing down MySearchTask"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">agent_name</span><span class="p">))</span>
</pre></div>
<p>Note, how we have access to other objects in the skill via <code>self.context</code>.</p>
<p>We place this code in <code>my_aea/skills/my_search/tasks.py</code>.</p>
<h2 id="step-5-create-the-config-file">Step 5: Create the config file</h2>
<p>Based on our skill components above, we create the following config file.</p>
<div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my_search</span>
<span class="nt">author</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">fetchai</span>
<span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">0.1.0</span>
<span class="nt">license</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Apache-2.0</span>
<span class="nt">description</span><span class="p">:</span> <span class="s">'A</span><span class="nv"> </span><span class="s">simple</span><span class="nv"> </span><span class="s">search</span><span class="nv"> </span><span class="s">skill</span><span class="nv"> </span><span class="s">utilising</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">OEF.'</span>
<span class="nt">behaviours</span><span class="p">:</span>
  <span class="nt">my_search_behaviour</span><span class="p">:</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MySearchBehaviour</span>
    <span class="nt">args</span><span class="p">:</span>
      <span class="nt">tick_interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">handlers</span><span class="p">:</span>
  <span class="nt">my_search_handler</span><span class="p">:</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MySearchHandler</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
  <span class="nt">my_search_task</span><span class="p">:</span>
    <span class="nt">class_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">MySearchTask</span>
    <span class="nt">args</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
<span class="nt">models</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
<span class="nt">protocols</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">'fetchai/oef:0.1.0'</span><span class="p p-Indicator">]</span>
<span class="nt">dependencies</span><span class="p">:</span> <span class="p p-Indicator">{}</span>
</pre></div>
<p>Importantly, the keys <code>my_search_behaviour</code> and <code>my_search_handler</code> are used in the above task to access these skill components at runtime. We also set the <code>tick_interval</code> of the <code>TickerBehaviour</code> to <code>5</code> seconds.</p>
<p>We place this code in <code>my_aea/skills/my_search/skill.yaml</code>.</p>
<h2 id="step-6-add-the-oef-protocol-and-connection">Step 6: Add the oef protocol and connection</h2>
<p>Our AEA does not have the oef protocol yet so let's add it.
<div class="highlight"><pre><span></span>aea add protocol fetchai/oef:0.1.0
</pre></div></p>
<p>This adds the protocol to our AEA and makes it available on the path <code>packages.fetchai.protocols...</code>.</p>
<p>We also need to add the oef connection:
<div class="highlight"><pre><span></span>aea add connection fetchai/oef:0.1.0
</pre></div></p>
<h2 id="step-7-run-the-aea">Step 7: Run the AEA</h2>
<p>We first start an oef node (see the <a href="../connection/" target="_blank">connection section</a> for more details) in a separate terminal window.</p>
<div class="highlight"><pre><span></span>python scripts/oef/launch.py -c ./scripts/oef/launch_config.json
</pre></div>
<p>We can then launch our AEA.</p>
<div class="highlight"><pre><span></span>aea run --connections fetchai/oef:0.1.0
</pre></div>
<p>We can see that the AEA sends search requests to the OEF and receives search responses from the OEF. Since our AEA is only searching on the OEF - and not registered on the OEF - the search response returns an empty list of agents.</p>
<p>We stop the AEA with <code>CTRL + C</code>.</p>
<h2 id="now-its-your-turn">Now it's your turn</h2>
<p>We hope this step by step introduction has helped you develop your own skill. We are excited to see what you will build.</p>
<p><br/></p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../aea-vs-mvc/" rel="prev" title="AEA and Web Frameworks">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                AEA and Web Frameworks
              </span>
</div>
</a>
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../build-aea-programmatically/" rel="next" title="Build an AEA programmatically">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Build an AEA programmatically
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/application.808e90bb.js"></script>
<script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
<script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
</body>
</html>